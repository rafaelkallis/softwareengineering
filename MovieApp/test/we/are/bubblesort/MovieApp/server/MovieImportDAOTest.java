package we.are.bubblesort.MovieApp.server;

import static org.junit.Assert.*;

import java.io.IOException;

import org.junit.Test;

import we.are.bubblesort.MovieApp.server.MovieImportDAO;
import we.are.bubblesort.MovieApp.shared.ImportException;

public class MovieImportDAOTest {

	@Test(expected=ImportException.class)
	public void testUnsupportedImport() throws ImportException, IOException{
		String content = "975900,/m/03vyhn,Ghosts of Mars,2001-08-24,14010832,98.0,{\"/m/02h40lc\": \"English Language\"},{\"/m/09c7w0\": \"United States of America\"},{\"/m/01jfsb\": \"Thriller\", \"/m/06n90\": \"Science Fiction\", \"/m/03npn\": \"Horror\", \"/m/03k9fj\": \"Adventure\", \"/m/0fdjb\": \"Supernatural\", \"/m/02kdv5l\": \"Action\", \"/m/09zvmj\": \"Space western\"}";	
		@SuppressWarnings("unused")
		MovieImportDAO dao = new MovieImportDAO(content);
	}
	
	@Test
	public void testShuffle() throws ImportException, IOException {
		String content = "975900	/m/03vyhn	Ghosts of Mars	2001-08-24	14010832	98.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/01jfsb\": \"Thriller\", \"/m/06n90\": \"Science Fiction\", \"/m/03npn\": \"Horror\", \"/m/03k9fj\": \"Adventure\", \"/m/0fdjb\": \"Supernatural\", \"/m/02kdv5l\": \"Action\", \"/m/09zvmj\": \"Space western\"}\n3196793	/m/08yl5d	Getting Away with Murder: The JonBenét Ramsey Mystery	2000-02-16		95.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/02n4kr\": \"Mystery\", \"/m/03bxz7\": \"Biographical film\", \"/m/07s9rl0\": \"Drama\", \"/m/0hj3n01\": \"Crime Drama\"}\n28463795	/m/0crgdbh	Brun bitter	1988		83.0	{\"/m/05f_3\": \"Norwegian Language\"}	{\"/m/05b4w\": \"Norway\"}	{\"/m/0lsxr\": \"Crime Fiction\", \"/m/07s9rl0\": \"Drama\"}\n9363483	/m/0285_cd	White Of The Eye	1987		110.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/07ssc\": \"United Kingdom\"}	{\"/m/01jfsb\": \"Thriller\", \"/m/0glj9q\": \"Erotic thriller\", \"/m/09blyk\": \"Psychological thriller\"}\n261236	/m/01mrr1	A Woman in Flames	1983		106.0	{\"/m/04306rv\": \"German Language\"}	{\"/m/0345h\": \"Germany\"}	{\"/m/07s9rl0\": \"Drama\"}\n13696889	/m/03cfc81	The Gangsters	1913-05-29		35.0	{\"/m/06ppq\": \"Silent film\", \"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/02hmvc\": \"Short Film\", \"/m/06ppq\": \"Silent film\", \"/m/0219x_\": \"Indie\", \"/m/01g6gs\": \"Black-and-white\", \"/m/01z4y\": \"Comedy\"}\n18998739	/m/04jcqvw	The Sorcerer's Apprentice	2002		86.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/0hzlz\": \"South Africa\"}	{\"/m/0hqxf\": \"Family Film\", \"/m/01hmnh\": \"Fantasy\", \"/m/03k9fj\": \"Adventure\", \"/m/03q4nz\": \"World cinema\"}\n10408933	/m/02qc0j7	Alexander's Ragtime Band	1938-08-16	3600000	106.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/04t36\": \"Musical\", \"/m/01z4y\": \"Comedy\", \"/m/01g6gs\": \"Black-and-white\"}\n9997961	/m/06_y2j7	Contigo y aquí	1974			{\"/m/06nm1\": \"Spanish Language\"}	{\"/m/0jgd\": \"Argentina\"}	{\"/m/04t36\": \"Musical\", \"/m/07s9rl0\": \"Drama\", \"/m/01z4y\": \"Comedy\"}\n2345652	/m/075f66	City of the Dead	1960		76.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/07ssc\": \"United Kingdom\"}	{\"/m/03npn\": \"Horror\", \"/m/0fdjb\": \"Supernatural\"}\n175026	/m/017n1p	Sarah and Son	1930		86.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/07s9rl0\": \"Drama\", \"/m/01g6gs\": \"Black-and-white\"}\n24229100	/m/07kjkz6	Lady Snowblood 2: Love Song of Vengeance	1974		89.0	{\"/m/03_9r\": \"Japanese Language\"}	{\"/m/03_3d\": \"Japan\"}	{\"/m/0lsxr\": \"Crime Fiction\", \"/m/01jfsb\": \"Thriller\", \"/m/0gw5n2f\": \"Japanese Movies\", \"/m/03q4nz\": \"World cinema\", \"/m/03btsm8\": \"Action/Adventure\"}\n6631279	/m/0gffwj	Little city	1997-04-04		93.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/06cvj\": \"Romantic comedy\", \"/m/0hj3n0w\": \"Ensemble Film\", \"/m/01t_vv\": \"Comedy-drama\", \"/m/07s9rl0\": \"Drama\", \"/m/01z4y\": \"Comedy\", \"/m/068d7h\": \"Romantic drama\", \"/m/02l7c8\": \"Romance Film\"}\n171005	/m/016ywb	Henry V	1989-11-08	10161099	137.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/07ssc\": \"United Kingdom\"}	{\"/m/04xvh5\": \"Costume drama\", \"/m/082gq\": \"War film\", \"/m/06l3bl\": \"Epic\", \"/m/04xvlr\": \"Period piece\", \"/m/07s9rl0\": \"Drama\", \"/m/060__y\": \"Film adaptation\"}\n18296435	/m/04cqrs4	Aaah Belinda	1986			{\"/m/02hwyss\": \"Turkish Language\"}	{\"/m/01znc_\": \"Turkey\"}	{\"/m/01z4y\": \"Comedy\"}\n11250635	/m/02r52hc	The Mechanical Monsters				{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/06n90\": \"Science Fiction\", \"/m/03k9fj\": \"Adventure\", \"/m/0hcr\": \"Animation\", \"/m/02hmvc\": \"Short Film\", \"/m/01hmnh\": \"Fantasy\", \"/m/0hqxf\": \"Family Film\", \"/m/02kdv5l\": \"Action\"}\n30388930	/m/0g5qvzg	1919	1984		99.0	{}	{}	{\"/m/07s9rl0\": \"Drama\"}\n77856	/m/0kcn7	Mary Poppins	1964-08-27	102272727	139.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/0hj3myq\": \"Children's/Family\", \"/m/04t36\": \"Musical\", \"/m/01hmnh\": \"Fantasy\", \"/m/01z4y\": \"Comedy\", \"/m/07s9rl0\": \"Drama\", \"/m/0hqxf\": \"Family Film\", \"/m/0hj3myc\": \"Children's Fantasy\"}\n32456683	/m/0gyryjt	Die Fahne von Kriwoj Rog	1967		108.0	{\"/m/04306rv\": \"German Language\"}	{\"/m/03f2w\": \"German Democratic Republic\"}	{}\n33420460	/m/0gj30jx	Keep the Change	1992		97.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/07s9rl0\": \"Drama\"}\n175024	/m/017n1b	The Devil's Holiday	1930			{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/02l7c8\": \"Romance Film\", \"/m/07s9rl0\": \"Drama\", \"/m/01g6gs\": \"Black-and-white\"}\n612710	/m/02wjqm	New Rose Hotel	1999-10-01	21521	92.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/01jfsb\": \"Thriller\", \"/m/06n90\": \"Science Fiction\", \"/m/0279xh5\": \"Future noir\", \"/m/0219x_\": \"Indie\", \"/m/0glj9q\": \"Erotic thriller\", \"/m/01hmnh\": \"Fantasy\", \"/m/060__y\": \"Film adaptation\", \"/m/07s9rl0\": \"Drama\"}\n21926710	/m/05p45cv	White on Rice	2009		82.0	{}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/06cvj\": \"Romantic comedy\", \"/m/02l7c8\": \"Romance Film\", \"/m/01z4y\": \"Comedy\", \"/m/0219x_\": \"Indie\"}\n33427105	/m/0h964n1	Freddy and the Song of the South Pacific	1962-09-12		97.0	{\"/m/04306rv\": \"German Language\"}	{\"/m/0345h\": \"Germany\"}	{\"/m/07s9rl0\": \"Drama\", \"/m/03k9fj\": \"Adventure\"}\n31983669	/m/0g4_n3m	Road to Life	1931-09-30		104.0	{\"/m/06b_j\": \"Russian Language\"}	{\"/m/05vz3zq\": \"Soviet Union\"}	{\"/m/07s9rl0\": \"Drama\"}\n17715326	/m/047t9rb	Camera Thrills	1935-09-01		25.0	{\"/m/02h40lc\": \"English Language\"}	{\"/m/09c7w0\": \"United States of America\"}	{\"/m/02hmvc\": \"Short Film\"}";
		MovieImportDAO [] daos = MovieImportDAO.shuffle(content	, 2);
		assertEquals(13 ,daos.length);
		assertEquals(2, daos[0].n_movies);
		
		daos = MovieImportDAO.shuffle(content, 10);
		assertEquals(3, daos.length);
		assertEquals(10,daos[0].n_movies);
		assertEquals(6,daos[2].n_movies);
	}

}
